function beep(){snd1.play()}function scrollToAnchor(e){var a;try{a=$("a[name='"+e+"']"),$("html,body").animate({scrollTop:a.offset().top-100},"slow")}catch(t){try{a=$("div[id='"+e+"']"),$("html,body").animate({scrollTop:a.offset().top},"slow")}catch(t){beep(),ga("send","exception",{exDescription:t.message,exFatal:!1})}}}function showGlossaryModal(e){window.vm.popupGlossaryBox(e)}function openTopMenu(){document.getElementById("topMenu").classList.toggle("show"),window.vm.loginStateMenuSet()}function doSearchAnalysis(){window.vm.doSearchAnalysis()}function closeTopMenu(){$("#topMenu").removeClass("show")}function openStart(){closeTopMenu(),$("#accordion").accordion({active:accordions.start})}function openSearchTab(){closeTopMenu(),$("#accordion").accordion({active:accordions.search})}function gotoArticleListTab(){closeTopMenu(),$("#accordion").accordion({active:accordions.articles})}function openAbstractTab(){closeTopMenu(),$("#accordion").accordion({active:accordions["abstract"]})}function gotoOptionsDialog(){closeTopMenu(),$("#optionsModal").modal("show")}function gotoFederationLoginDialog(){closeTopMenu(),setCookie("federationLogin",!0,100),$("#federationLoginModal").modal("show")}function gotoAboutPEPEasy(){closeTopMenu(),$("#aboutPEPEasyModal").modal("show")}function gotoHelpSearchDialog(){ga("set","page","/Search/Tips/"),ga("send","pageview"),closeTopMenu(),$("#helpSearchSyntax").modal("show")}function gotoNewSearch(){location.hash="/Search/"}function gotoSelectSortOrder(){closeTopMenu(),$("#sortSelectionModal").modal("show")}function getStatusMessageObjectText(e,a){var t="";if(null!==e){var s=e.messageID,r=e.description;if(null!==s&&"limited"!==s&&"ajaxUncaught"!==s){var o=_(s);t=""===o?""!==r&&null!==r?r:s:o}else t=r}else null!==a&&void 0!==a&&(t=_(a));return t}function PEPArticlesViewModel(){function r(){var e=this;this.currentArticleListHash=location.hash,this.baseAPIRequest="",this.currItemNumber=0,this.limit=25,this.lastItemNumber=0,this.pageEndItemNumber=0,this.availableItemCount=0,this.fullCountComplete=!1,this.fullCount=0,this.responseInfo=ko.observable(),this.displayString=ko.observable(""),this.lastSearchAPIString="",this.pageSize=ko.computed(function(){return setCookie("returnSetSize",t.selectedReturnSetSize(),100),e.limit=parseInt(t.selectedReturnSetSize()),t.selectedReturnSetSize()},this),this.currPageNumber=ko.computed(function(){var a=Math.floor(e.currItemNumber/e.limit);return a},this),this.searchResultsArea=ko.computed(function(){var e=t.articleList().length;0===e?($("#searchFormResults").hide(),$("#articleListLeadin").hide()):($("#searchFormResults").show(),$("#articleListLeadin").show())},this),this.searchFinishedCallback=function(a){e.availableItemCount=a.fullCount,0===a.fullCount?t.noMatchesFoundMessage(_("jsNoMatches")):t.noMatchesFoundMessage(""),e.availableCountCompleteBool=a.fullCountComplete,e.virtualItemCount=a.totalMatchCount,e.currItemNumber=a.offset,t.searchResultsOffset(e.currItemNumber),t.currentSearchProgress(""),e.displayString();var s=_("jsViewing",{currItem:parseInt(e.currItemNumber)+1,lastItem:Math.min(e.lastItemNumber+1,e.availableItemCount),itemCount:e.availableItemCount});e.availableCountCompleteBool||(s+=" "+_("jsFullSet",{virtualItemCount:parseInt(e.virtualItemCount)})),"{{jsViewing}}"!==s&&e.displayString(s),t.isValidKWIC(a.hasKWIC),t.fixKWICdisplay()},this.init=function(a,s,r){e.baseAPIRequest=a,"undefined"==typeof s?e.currItemNumber=0:e.currItemNumber=parseInt(s),"undefined"!=typeof r&&(e.limit=parseInt(r)),a!==e.lastSearchAPIString&&(e.currItemNumber=0,e.lastSearchAPIString=a),e.lastItemNumber=e.currItemNumber+e.limit-1;var o=a+"&limit="+e.limit+"&offset="+e.currItemNumber;t.articleList([]),e.currentArticleListHash=location.hash,t.currentSearchProgress("Please wait...Fetching article list..."),getListOfArticles(o,t.articleList,e.searchFinishedCallback)},this.showPage=function(){return e.currentArticleListHash=e.currentArticleListHash.replace(/&limit=[0-9]+/g,""),e.currentArticleListHash=e.currentArticleListHash.replace(/&offset=.*[0-9]+/g,""),location.hash=e.currentArticleListHash+"&limit="+e.pageSize()+"&offset="+e.currItemNumber,!0},this.goToNextPage=function(){var a=parseInt(t.selectedReturnSetSize()),s=parseInt(e.currItemNumber)+a;return s+a>e.availableItemCount&&(s=Math.max(e.availableItemCount-a,0)),e.currItemNumber=s,t.searchResultsOffset(s),e.showPage(),!1},this.goToPrevPage=function(){var a=parseInt(t.selectedReturnSetSize()),s=parseInt(e.currItemNumber)-a;0>s&&(s=0),e.currItemNumber=s,t.searchResultsOffset(s);$(".accordion").accordion("option","active");return e.showPage(),!1}}var s,e=300,a=25,t=this;t.journals=ko.observableArray([]),t.videos=ko.observableArray([]),t.isValidKWIC=ko.observable(!1),t.noMatchesFoundMessage=ko.observable(""),t.articleList=ko.observableArray([]),t.articleAbstract=ko.observable(""),t.currAbstractDocumentID=ko.observable(""),t.currDocumentID="",t.currGlossaryTermID=ko.observable(""),t.currGlossaryEntryHTML=ko.observable(""),t.currWhatsNewList=ko.observableArray([]),t.currMostCitedData=ko.observableArray([]),t.currMostDownloadedData=ko.observableArray([]),t.userName=ko.observable(""),t.userPassword=ko.observable(""),t.accessToken=ko.observable(""),t.searchResultsLimit=ko.observable(15),t.searchResultsOffset=ko.observable(0),t.matchCount=ko.observable(0),t.searchTitleText=ko.observable(""),t.searchAuthorText=ko.observable(""),t.searchYearText=ko.observable(""),t.searchDateTypeText=ko.observable(""),t.searchWordsText=ko.observable(""),t.queryString=ko.observable(""),t.searchJournal=ko.observable("All"),t.searchVolume=ko.observable(""),t.searchIssue=ko.observable(""),t.searchAnalysisArray=ko.observableArray([]),t.searchAnalysisPending=!1,t.searchAnalysisClearPending=!1,t.facebookLink=ko.observable(""),t.twitterLink=ko.observable(""),t.mailtoLink=ko.observable(""),t.journalFieldPlaceholder="testing 1 2 3",t.selectedFontSize=ko.observable("1.5"),t.selectedReturnSetSize=ko.observable(parseInt(getCookie("returnSetSize","25"))),t.searchSortOrder=ko.observable("rank"),t.searchSortOrder(getCookie("sortOrder","rank")),t.showRanks=ko.observable(!1),t.skipAbstractMode=ko.observable("true"===getCookie("skipAbstractMode","false")),t.showTermMatchesinCompactView=ko.observable(!1),t.showKWIC=ko.observable(!1),"true"===getCookie("showKWIC")?t.showKWIC(!0):t.showKWIC(!1),t.lastServerSearchString=ko.observable(""),t.currentSearchDisplayString=ko.observable(""),t.currentSearchProgress=ko.observable(""),t.stayLoggedIn=ko.observable(!1),t.loginStateCheckInterval=a,t.loginMenuState=ko.observable(""),t.statusMessageLocal=ko.observable(""),t.selectedStyleSheet=ko.observable(""),t.extendedLoginStatus=ko.observable(""),t.lastAction="",t.requestedHTMLAnchor="",t.loggedInToServerObs=ko.observable(),t.readModeIsDocument=ko.observable(!1),t.getStoredAccessToken=function(){var e;e=getCookie("PHPSESSID"),""!==e?t.accessToken(e):t.accessToken("")},t.quickSearchTypeWords=ko.observable(!1),t.compactSearchModeSelected=ko.observable(getCookie("compactSearchModeSelected","titleAuthorWords")),"true"===getCookie("showFullSearchForm")?t.showFullSearchForm=!0:t.showFullSearchForm=!1,t.broadenSearch=ko.observable(!1),"true"===getCookie("broadenSearch")?t.broadenSearch(!0):t.broadenSearch(!1),t.currentStatusLine=ko.computed(function(){var e="";return e=t.loggedInToServerObs()===!0?t.readModeIsDocument()===!0?"This is the full document.":"You are logged in and have access to full text to all articles other than the newer embargoed ones.":"You are not logged in.  You must be logged in to read or download full-text."},this),t.login=function(){t.loggedInToServerObs()!==!0?$("#loginModal").modal("show"):alert("You are already logged in.")},t.acceptCredentials=function(e){loginToServer(baseURL,t.userName(),t.userPassword(),t.loginToServerStatusCallback,t.stayLoggedIn()),$("#loginModal").modal("hide")},t.loginToServerStatusCallback=function(e,a,s,r){e===!1?(console.warn("Login Failed: "+a),ga("set","page","/Login/Fail/"),ga("send","pageview"),t.loggedInToServerObs(!1),t.accessToken(""),t.extendedLoginStatus(a.error_description),null!==t.intervalID&&(clearInterval(t.intervalID),t.intervalID=null)):(ga("set","page","/Login/Success/"),ga("send","pageview"),t.extendedLoginStatus(_("jsStatusLoggedIn")),t.loggedInToServerObs(!0),t.accessToken(r),t.createHearbeatTimer()),t.loginStateMenuSet()},t.createHearbeatTimer=function(){var s;s=t.stayLoggedIn()?e:a,t.loginStateCheckInterval=1e3*s*60,null!==t.intervalID&&clearInterval(t.intervalID),t.intervalID=setInterval(function(){t.getCurrentLoginStatus()},t.loginStateCheckInterval)},t.getCurrentLoginStatus=function(){""===t.accessToken()&&"IPLogin"!==t.accessToken()&&t.getStoredAccessToken(),""!==t.accessToken()&&checkLoginStatus(baseURL,t.accessToken(),t.loginStatusCallback)},t.loginStatusCallback=function(e,a){t.loggedInToServerObs(e),e===!1?(deleteCookie("federationLogin"),deleteCookie("federationLoggedInSuccess"),t.showReadandDownloadButtons(!1),null!==t.intervalID&&(clearInterval(t.intervalID),t.intervalID=null)):""===t.accessToken()&&("true"===getCookie("federationLogin")&&(setCookie("federationLoggedInSuccess",!0,100),deleteCookie("federationLogin"),console.log("Federation IPLogin")),t.accessToken("IPLogin"),console.log("IPLogin"))},t.showReadandDownloadButtons=function(e){t.loggedInToServerObs()!==!0?$("#authenticatedButtonFunctions").hide():e===!0?$("#authenticatedButtonFunctions").show():$("#authenticatedButtonFunctions").hide()},t.loginStateMenuSet=function(){var e;return t.loggedInToServerObs()===!1?(t.loginMenuState(_("jsLogIn")),t.accessToken(""),e=!1):(getCookie("federationLoggedInSuccess")!==!0?"IPLogin"===t.accessToken()?t.loginMenuState(_("jsLoginViaIP")):t.loginMenuState(_("jsLogOut")):"IPLogin"===t.accessToken()?t.loginMenuState("LoggedInFederation"):t.loginMenuState(_("jsLogOut")),e=!0),e},t.logoutFromServerCallback=function(e,a){console.log("Log out acknowledged by server. "+a),deleteCookie("federationLogin"),deleteCookie("federationLoggedInSuccess")},t.loginStateToggle=function(){closeTopMenu(),"IPLogin"!==t.accessToken()&&(t.loggedInToServerObs()===!0?(deleteCookie("PHPSESSID"),t.accessToken(""),t.extendedLoginStatus(_("jsStatusNotLoggedIn")),t.loggedInToServerObs(!1),logoutFromServer(baseURL,t.logoutFromServerCallback,t.stayLoggedIn())):t.login())},t.getStoredAccessToken(),checkLoginStatus(baseURL,t.accessToken(),t.loginStatusCallback),t.closeModals=function(){$("#ftnModal").modal("hide"),$("#refModal").modal("hide")},t.changeShowStateObjects=function(e){"undefined"!=typeof e?t.showFullSearchForm=e:t.showFullSearchForm=!t.showFullSearchForm,t.showFullSearchForm===!0?($(".searchFormFields").show(),$("#termMatchStatArea").show(),$(".criteriaMore").hide(),$(".criteriaLess").show()):($("#termMatchStatArea").hide(),$(".searchFormFields").hide(),"authorWordsSearch"===t.compactSearchModeSelected()?($(".searchAuthorField").show(),$(".searchWordsField").show(),t.showTermMatchesinCompactView()&&$("#termMatchStatArea").show()):"wordsJournalSearch"===t.compactSearchModeSelected()?($(".searchWordsField").show(),$(".searchJournalField").show(),t.showTermMatchesinCompactView()&&$("#termMatchStatArea").show()):"authorTitleSearch"===t.compactSearchModeSelected()?($(".searchAuthorField").show(),$(".searchTitleField").show()):"wordsSearch"===t.compactSearchModeSelected()?($(".searchWordsField").show(),$("#termMatchStatArea").show()):($(".searchAuthorField").show(),$(".searchTitleField").show(),$(".searchWordsField").show(),t.showTermMatchesinCompactView()&&$("#termMatchStatArea").show()),$(".criteriaMore").show(),$(".criteriaLess").hide())},t.changeShowStateObjects(t.showFullSearchForm),t.changedquickSearchTypeWords=function(){return setCookie("quickSearchTypeWords",t.quickSearchTypeWords(),100),t.changeShowStateObjects(t.showFullSearchForm),!0},t.showGlossaryTerms=ko.observable(),t.justifyText=ko.observable(),t.indexResults={currAuthorIndexData:ko.observableArray([]),currMatchText:ko.observable(),limit:15},t.matchIndex=function(e){var a;e.length>3&&(e!=t.searchAuthorText()&&t.searchAuthorText(e),a=baseURL+"/v1/Authors/Index/"+t.searchAuthorText()+"?limit="+t.indexResults.limit,t.indexResults.currAuthorIndexData([]),getListOfcurrAuthorIndexData(a,t.indexResults.currAuthorIndexData))},t.searchAuthorText.subscribe(t.matchIndex),t.selectedLanguage=ko.observable(getCookie("language",document.documentElement.lang)),t.showGlossaryTerms(setGlossaryStyle("cookie")),t.justifyText(setJustifyStyle("cookie")),t.getSearchStringFromForm=function(){var a,e="",s="",r="?",o="";if(""!==t.searchAuthorText()&&(e=-1!==t.searchAuthorText().indexOf(",")&&-1===t.searchAuthorText().indexOf('"')?r+'author="'+t.searchAuthorText()+'"':r+"author="+t.searchAuthorText(),t.broadenSearch()===!0&&"*"!==t.searchAuthorText().substr(t.searchAuthorText().length-1)&&(e=e.replace(/([\S]+(?=[ ]|$))/g,"$1*"),e=e.replace(/(\*{2,6})/g,"*")),r="&"),""!==t.searchTitleText()&&(e=e+r+"title="+t.searchTitleText(),t.broadenSearch()===!0&&"*"!==t.searchTitleText().substr(t.searchTitleText().length-1)&&(e=e.replace(/([\S]+(?=[ ]|$))/g,"$1*"),e=e.replace(/(\*{2,6})/g,"*")),r="&"),void 0===t.searchJournal()&&t.searchJournal("All"),"All"!==t.searchJournal()&&void 0!==t.searchJournal()&&(e=e+r+"journal="+t.searchJournal(),r="&"),""!==t.searchYearText()){var n=new Date,i=n.getFullYear()+1;a=t.searchYearText(),s="";var c="";switch(a.substring(0,1)){case"^":t.searchDateTypeText("Between");var l=a.split("-");s=l[0],s=s.substring(1),c=l[1],o+='<span class="criteriaLabel">Date Between:</span>'+a+" ";break;case">":t.searchDateTypeText("Since"),s=a.substring(1),o+='<span class="criteriaLabel">Date After:</span>'+a+" ",c=i;break;case"<":t.searchDateTypeText("Before"),s=a.substring(1),o+='<span class="criteriaLabel">Date Before:</span>'+a+" ";break;default:t.searchDateTypeText("On"),s=a,o+='<span class="criteriaLabel">Date On:</span>'+a+" "}e=e+r+"datetype="+t.searchDateTypeText()+"&startyear="+s+"&endyear="+c,r="&"}return""!==t.searchWordsText()&&(e=e+r+"fulltext1="+t.searchWordsText(),o+='<span class="criteriaLabel">Words or phrases:</span>'+t.searchWordsText()+" ",r="&"),""!==e&&(e+="&sort="+t.searchSortOrder()),{searchString:e,displayString:o}},t.searchAnalysisComplete=function(){t.searchAnalysisPending=!1,t.searchAnalysisClearPending===!0&&(t.searchAnalysisArray([]),t.searchAnalysisClearPending=!1)},t.doSearchAnalysis=function(){var e=t.getSearchStringFromForm(),a=e.searchString,s="/v1/Database/SearchAnalysis/"+a;t.searchAnalysisPending=!0,getSearchAnalysis(baseURL+s,t.searchAnalysisArray,t.searchAnalysisComplete)},t.articleListPager1=new r,t.expandSearchForm=function(){t.changeShowStateObjects(!t.showFullSearchForm),setCookie("showFullSearchForm",t.showFullSearchForm,100)},t.fixKWICdisplay=function(){t.showKWIC()===!1?$(".kwicList").hide():$(".kwicList").show()},t.toggleKWIC=ko.computed(function(){t.showKWIC()===!1?$(".kwicList").hide():$(".kwicList").show()},this),t.toggleKWICCheck=function(){t.showKWIC(!t.showKWIC()),setCookie("showKWIC",t.showKWIC(),100)},t.fontSizeChanged=function(){setFontSize(t.selectedFontSize())},t.getAbstractCallback=function(e,a,s){null===s?t.articleAbstract("Abstract not found."):(t.currAbstractDocumentID(a),t.currDocumentID="",t.articleAbstract(s["abstract"])),s.accessLimited===!1?t.showReadandDownloadButtons(!0):t.showReadandDownloadButtons(!1),t.getCurrentLoginStatus(),t.extendedLoginStatus(""),null!==e?t.extendedLoginStatus(e.description):void 0!==s.accessLimitedDescription&&s.accessLimited===!0?t.extendedLoginStatus(s.accessLimitedDescription):void 0!==s.accessLimitedReason&&s.accessLimited===!0&&t.extendedLoginStatus(s.accessLimitedReason)},t.sourcesLoadedCallback=function(e,a){t.journals.sort(sort_by("title",!0,function(e){return e.toUpperCase()})),t.journals.unshift({sourceType:"Videos",title:"All Videos",PEPCode:videoPEPCodesSearchSpec,volume:null,documentID:null,issn:null,isbn:null}),t.journals.unshift({sourceType:"Journals",title:"All Journals",PEPCode:journalPEPCodeSearchSpec,volume:null,documentID:null,issn:null,isbn:null}),t.journals.unshift({sourceType:"Books",title:"All Books",PEPCode:bookPEPCodesSearchSpec,volume:null,documentID:null,issn:null,isbn:null}),t.journals.unshift({title:"All Sources",PEPCode:"All"})},t.popupGlossaryBox=function(e){t.currGlossaryTermID(e),t.loggedInToServerObs()===!0?(ga("set","page","/Glossary/"+t.currGlossaryTermID()),ga("send","pageview"),$("#glossayModal").modal("show"),t.currGlossaryEntryHTML(_("jsLoadingGlossaryEntry")),getDocumentData(t.currGlossaryTermID(),t.accessToken(),t.glossaryEntryHTMLCallback)):alert(_("jsMustBeLoggedInGlossary"))},t.gotoArticleAbstract=function(e){closeTopMenu(),t.skipAbstractMode()&&t.loggedInToServerObs()?location.hash="/Document/"+e.documentID:location.hash="/Abstract/"+e.documentID},t.gotoArticleFullText=function(e){closeTopMenu(),location.hash==="/Document/"+t.currAbstractDocumentID()?t.articleAbstract.search("Authentication error")>0&&location.reload():location.hash="/Document/"+t.currAbstractDocumentID()},t.gotoIssueContents=function(e){var a=e.PEPCode.toUpperCase(),t=e.vol,s=e.issueInfo;location.hash="/ArticleList/?journal="+a+"&vol="+t+"&issue="+s},t.getDownloadEPUB=function(e){if(t.getCurrentLoginStatus()===!1)t.login("");else{var a;t.extendedLoginStatus(_("DownloadRequested")),a=baseURL+"/v1/Documents/Downloads/EPUB/"+t.currAbstractDocumentID()+"/",ga("set","page","/Documents/Downloads/EPub/"+t.currAbstractDocumentID()),ga("send","pageview"),getDocumentDownload(a,t.currAbstractDocumentID(),"epub",t.accessToken(),t.documentDownloadReadyCallback)}},t.getDownloadPDF=function(){var e,a,s,r="";t.getCurrentLoginStatus()===!1?t.login(""):(t.extendedLoginStatus(_("DownloadRequested")),r=t.currAbstractDocumentID(),a=r.search(/ANIJP-CHI|IJPOpen/i),e=-1!==a?"?option=embed1":"",s=baseURL+"/v1/Documents/Downloads/PDF/"+r+e,ga("set","page","/Documents/Downloads/PDF/"+t.currAbstractDocumentID()),ga("send","pageview"),getDocumentDownload(s,r,"pdf",t.accessToken(),t.documentDownloadReadyCallback))},t.getDownloadHTML=function(e){t.articleAbstract("...loading..."),getDocumentData(e+"/"+t.lastServerSearchString(),t.accessToken(),t.documentHTMLReadyCallback)},t.documentHTMLReadyCallback=function(e,a,s,r){200!==a?(null===s?t.extendedLoginStatus("(Error Code "+a+")"):t.extendedLoginStatus(getStatusMessageObjectText(s)),t.articleAbstract("")):(t.readModeIsDocument(!0),r.accessLimited===!0?t.showReadandDownloadButtons(!1):t.showReadandDownloadButtons(!0),t.currAbstractDocumentID(r.documentID),t.currDocumentID=r.documentID,t.articleAbstract(r.document),hitCursor.initialize(),""!==t.requestedHTMLAnchor&&(scrollToAnchor(t.requestedHTMLAnchor),t.requestedHTMLAnchor="")),t.extendedLoginStatus(getStatusMessageObjectText(s))},t.glossaryEntryHTMLCallback=function(e,a,s,r){200!==a?t.currGlossaryEntryHTML(getStatusMessageObjectText(s,"jsMustBeLoggedInGlossary")):t.currGlossaryEntryHTML(r.document)},t.documentDownloadReadyCallback=function(e,a,s,r,o){if(200!==a)t.extendedLoginStatus(getStatusMessageObjectText(s));else{var n;n=null===o?getStatusMessageObjectText(s,"downloadFail"):_("DownloadSuccessful",{downloadFilename:o}),t.extendedLoginStatus(n)}},t.changedGlossaryStyle=function(e){return t.showGlossaryTerms()===!0?setGlossaryStyle(!0):setGlossaryStyle(!1),!0},t.changedBroadenSearch=function(){return setCookie("broadenSearch",t.broadenSearch(),100),!0},t.changedJustifyStyle=function(e){return t.justifyText()===!0?setJustifyStyle(!0):setJustifyStyle(!1),!0},t.changedAbstractMode=function(e){return setCookie("skipAbstractMode",t.skipAbstractMode(),100),ga("set","page","/skipAbstractMode/"+t.skipAbstractMode()),ga("send","pageview"),!0},t.changedStayLoggedIn=function(e){return t.createHearbeatTimer(),!0},t.compactSearchMode=ko.computed(function(){var e=this.compactSearchModeSelected();return setCookie("compactSearchModeSelected",e,100),t.changeShowStateObjects(t.showFullSearchForm),ga("set","page","/SearchMode/"+e),ga("send","pageview"),e},this),t.languageSelection=ko.computed(function(){var e=this.selectedLanguage();return ga("set","page","/Language/"+e),ga("send","pageview"),e.length>1&&(document.webL10n.setLanguage(e),setCookie("language",e,100)),e},this),t.styleSelectionChanged=function(e,a){a.originalEvent?(switch_style(t.selectedStyleSheet()),ga("set","page","/Theme/"+t.selectedStyleSheet()),ga("send","pageview")):alert("event2!")},t.sortOrderChanged=function(e,a){a.originalEvent?(t.doSearch(e,a),setCookie("sortOrder",t.searchSortOrder(),100),ga("set","page","/SortOrder/"+t.searchSortOrder()),ga("send","pageview")):alert("unexpected error-cannot perform sort order!")},t.doClear=function(e){t.searchAuthorText(""),t.searchTitleText(""),t.searchYearText(""),t.searchJournal("All"),t.isValidKWIC(!1),t.articleList([]),t.searchWordsText(""),t.noMatchesFoundMessage(""),t.searchAnalysisPending&&(t.searchAnalysisClearPending=!0),t.searchAnalysisArray([])},t.gotoArticleNumber=function(e,a){var s=parseInt(t.searchResultsOffset());return t.searchResultsOffset(s),!1},t.doSearch=function(e,a){searchDisplayString="";var s=t.getSearchStringFromForm(),r=s.searchString;s.displayString;return""===r&&(r="?journal="),location.hash="/Search/"+r+"&limit="+t.selectedReturnSetSize()+"&offset="+t.searchResultsOffset(),!1},Sammy(function(){this.get("#LinkedDownloads/PDF/:docID",function(){this.params.docID;t.getDownloadPDF()}),this.get("#/",function(){}),this.get("#/ArticleList/",function(e){t.doClear();var a,s,r,o;t.currentSearchDisplayString("");var n=e.params.journal,i=e.params.vol,c=e.params.issue;e.params.page;a="undefined"==typeof e.params.limit?t.selectedReturnSetSize():e.params.limit,s="undefined"==typeof e.params.offset?0:e.params.offset;var u=document.webL10n.get;void 0!==c?(r="?journal="+n+"&volume="+i+"&issue="+c,o=u("jsSearchListingIss",{jrnlCode:n,jrnlVol:i,jrnlIss:c}),"{{jsSearchListingIss}}"!==o&&t.currentSearchDisplayString(o)):(r="?journal="+n+"&volume="+i,o=u("jsSearchListing",{jrnlCode:n,jrnlVol:i}),"{{jsSearchListing}}"!==o&&t.currentSearchDisplayString(o)),ga("set","page","/ArticleList/"+r),ga("send","pageview");var d=baseURL+"/v1/Database/Search/"+r;t.articleListPager1.init(d,s,a),t.showRanks(!1),$("#accordion").accordion({active:accordions.search})}),this.get("#/Search/?",function(e){ga("set","page","/Search/"),ga("send","pageview"),t.currentSearchDisplayString("");var a="";t.doClear(),t.showRanks(!1);var s;if(0===e.params.keys("toHash").length);else{void 0!==e.params.limit&&(s=e.params.offset>=0?e.params.limit:t.selectedReturnSetSize()),void 0!==e.params.offset?e.params.offset>=0&&t.searchResultsOffset(e.params.offset):t.searchResultsOffset(0);var r="",o="";if("undefined"!=typeof e.params.journal?(r=r+"?journal="+e.params.journal,t.searchJournal(e.params.journal),e.params.journal.search(/ipl or/i)>-1?t.searchJournal(bookPEPCodesSearchSpec):e.params.journal.search(/afcvs/i)>-1?t.searchJournal(videoPEPCodesSearchSpec):e.params.journal.search(/pdpsy/i)>-1?t.searchJournal(journalPEPCodeSearchSpec):(console.log("Why here?: '"+e.params.journal+"' "),t.searchJournal(e.params.journal)),a+=" in <b>Source(s): "+e.params.journal+"</b>"):(t.searchJournal("All"),r+="?journal="),"undefined"!=typeof e.params.author&&(r=r+"&author="+e.params.author,t.searchAuthorText(decodeHtml(e.params.author)),a+='<span class="criteriaLabel">Author(s):</span>'+t.searchAuthorText()+" "),"undefined"!=typeof e.params.title&&(r=r+"&title="+e.params.title,t.searchTitleText(decodeHtml(e.params.title)),a+='<span class="criteriaLabel">Title:</span>'+t.searchTitleText()+" "),"undefined"!=typeof e.params.startyear)switch(r=r+"&startyear="+e.params.startyear,"undefined"!=typeof e.params.endyear&&(r=r+"&endyear="+e.params.endyear),"undefined"!=typeof e.params.datetype?(r=r+"&datetype="+e.params.datetype,t.searchDateTypeText(e.params.datetype)):(r+="&datetype=On",t.searchDateTypeText("On")),t.searchDateTypeText()){case"Between":o="^",t.searchYearText(o+e.params.startyear+"-"+e.params.endyear),a+='<span class="criteriaLabel">Date Between:</span>'+e.params.startyear+"-"+e.params.endyear+" ";break;case"Since":o=">",t.searchYearText(o+e.params.startyear),a+='<span class="criteriaLabel">Date After:</span>'+o+e.params.startyear+" ";break;case"Before":o="<",t.searchYearText(o+e.params.startyear),a+='<span class="criteriaLabel">Date Before:</span>'+e.params.startyear+" ";break;case"On":o="",t.searchYearText(o+e.params.startyear),a+='<span class="criteriaLabel">Date On:</span>'+e.params.startyear+" ";break;default:o="",t.searchYearText(o+e.params.startyear)}if("undefined"!=typeof e.params.volume?(r=r+"&volume="+e.params.volume,t.searchVolume(e.params.volume),a+=""===t.searchJournal()?" in <b>volume "+e.params.volume+"</b>":" and <b>volume "+e.params.volume+"</b>"):t.searchVolume(""),"undefined"!=typeof e.params.issue?(r=r+"&issue="+e.params.issue,t.searchIssue(e.params.issue),a+=" in <b>issue "+e.params.issue+"</b>"):t.searchIssue(""),"undefined"!=typeof e.params.artqual&&(r=r+"&artqual="+e.params.artqual,a+="<span data-l10n-id='Related-documents' class=\"criteriaLabel\">Related Documents</span> "),"undefined"!=typeof e.params.origrx&&(r=r+"&origrx="+e.params.origrx,a+="<span data-l10n-id='Translations' class=\"criteriaLabel\">Available Translations</span> "),"undefined"!=typeof e.params.fulltext1){r=r+"&fulltext1="+e.params.fulltext1;_("jsWordsOrPhrases",{searchWordsText:t.searchWordsText()});t.searchWordsText(e.params.fulltext1),a+="<span data-l10n-id='Words-or-phrases' class='criteriaLabel'>Words or phrases:</span> "+t.searchWordsText()+" ",t.showRanks(!0)}else t.searchWordsText("");""===r&&alert("Please enter some search criteria"),ga("set","page","/Search/"+r),ga("send","pageview"),"undefined"!=typeof e.params.sort&&(r=r+"&sort="+e.params.sort,t.searchSortOrder(e.params.sort)),t.lastServerSearchString("?search='"+fixedEncodeURIComponent(r)+"'"),r+="&sort="+t.searchSortOrder(),t.doSearchAnalysis();var i=baseURL+"/v1/Database/Search/"+r;t.articleListPager1.init(i,t.searchResultsOffset(),s)}$("#accordion").accordion({active:accordions.search})}),this.get("#/Abstract/?",function(){$("#accordion").accordion({active:accordions["abstract"]}),ga("set","page","/Abstract/"),ga("send","pageview")}),this.get("#/Start/?",function(){$("#accordion").accordion({active:accordions.start})}),this.get("#/Abstract/:documentID",function(){var e=this.params.documentID;ga("set","page","/Abstract/"),ga("send","pageview"),t.currAbstractDocumentID(e),t.currDocumentID="",t.extendedLoginStatus(""),t.readModeIsDocument(!1),t.articleAbstract("...fetching abstract..."),void 0===t.loggedInToServerObs()&&checkLoginStatus(baseURL,t.accessToken(),t.loginStatusCallback),ga("set","page","/Abstract/"+e),ga("send","pageview"),getAbstractWithCred(e,t.accessToken(),t.getAbstractCallback),$("#accordion").accordion({active:accordions["abstract"]})}),this.get("#/Document/:documentID",function(){var e=this.params.documentID;ga("set","page","/Document/"),ga("send","pageview");var a=e.search("#"),s=!0;if(t.closeModals(),checkLoginStatus(baseURL,t.accessToken(),t.loginStatusCallback),t.loggedInToServerObs()===!1&&t.login(),t.loggedInToServerObs()===!1)return window.history.back(),!1;if(-1!==a){t.requestedHTMLAnchor=e.substring(a+1);var r=e.substring(0,a);r===t.currDocumentID&&(scrollToAnchor(t.requestedHTMLAnchor),s=!1)}else t.requestedHTMLAnchor="";s?(t.articleAbstract("... Loading Document ..."),ga("set","page","/Document/"+e),ga("send","pageview"),t.getDownloadHTML(e),$("#accordion").accordion({active:accordions["abstract"]}),window.scrollTo(0,0)):$("#accordion").accordion({active:accordions["abstract"]})}),this.get("",function(){})}).run(),getListOfWhatsNew(t.currWhatsNewList),getListOfMost(baseURL+"/v1/Database/MostCited/?period=5&limit=5",t.currMostCitedData,t.statusMessageLocal,serverFlag=!1),getListOfMost(baseURL+"/v1/Database/Search/?viewcount=90&viewperiod=month&limit=5",t.currMostDownloadedData,t.statusMessageLocal,serverFlag=!0),getListOfSources(baseURL+"/v1/Metadata/Journals/",t.journals,t.sourcesLoadedCallback),s=getCookie("style"),t.selectedStyleSheet(s),s=getCookie("fontSize","1.5"),t.selectedFontSize(s)}var snd1=new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");
if(!window.console){var noOp=function(){};console={log:noOp,warn:noOp,error:noOp}}var accordions={start:0,search:1,"abstract":2},_=document.webL10n.get,sort_by=function(e,a,t){var s=function(a){return t?t(a[e]):a[e]};return function(e,t){var r=s(e),o=s(t);return(o>r?-1:r>o?1:0)*[-1,1][+!!a]}},hitCursor={currPosition:0,endPosition:-1,hits:[],hitCount:0,firstHit:null,hitTag:"",initialize:function(){this.hits=$('a[name^="hit"]'),this.currPosition=0,this.hitCount=this.hits.length,this.endPosition=this.hitCount},prevHit:function(){if(closeTopMenu(),this.currPosition<=1)1===this.currPosition&&(this.hitTag="hit"+this.currPosition,scrollToAnchor(this.hitTag));else{this.currPosition=this.currPosition-1,this.hitTag="hit"+this.currPosition;try{scrollToAnchor(this.hitTag)}catch(e){console.warn("Can't find hit: "+this.hitTag+e)}}return!1},nextHit:function(){if(closeTopMenu(),this.currPosition===this.endPosition)console.warn("No next hit"),this.hitTag="hit"+this.currPosition,scrollToAnchor(this.hitTag);else{this.currPosition=this.currPosition+1,this.hitTag="hit"+this.currPosition;try{scrollToAnchor(this.hitTag)}catch(e){console.warn("Can't find hit: "+this.hitTag+e)}}return!1}};$("form input").on("keyup",function(e){13==e.keyCode&&doSearchAnalysis()});var baseURL="http://127.0.0.1:8000";window.vm=new PEPArticlesViewModel,ko.applyBindings(window.vm);